extends layout

include utils.pug
block content
  link(rel='stylesheet' href='/stylesheets/hike.css')
  link(rel="stylesheet" href="/stylesheets/review-form.css")
  script(src='/javascripts/reviews.js')
  script(src='/javascripts/collections.js')
  div.hike-page(id=`hikeId-${hike.id}`)
    div.hike-title(style=`background-image: linear-gradient(to bottom, rgba(0,0,0, 0), rgba(0,0,0,0.5)),url('${hike.imgUrl}'`)
      div.hike-name #{hike.name}
      div.hike-level-review
        div.hike-level #{hike.Difficulty.level}
        div.hike-review
          div.hike-stars
            span.star-sprite(style=`width:${avgReviewPtg}%`)
          div.hike-avg-review  #{avgReview}
      div.hike-location #{hike.CityPark.name}, #{hike.State.state}
    div.hike-content
      div.hike-details
        div.hike-description Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
        div.hike-key
          div.hike-key-wrap
            div.hike-key-title Length
            div.hike-key-detail #{hike.length} miles
          div.hike-key-wrap
            div.hike-key-title Elevation gain
            div.hike-key-detail #{hike.elevationChange} ft
          div.hike-key-wrap
            div.hike-key-title Route type
            div.hike-key-detail #{hike.RouteType.name}
        div.reviews
          div.rating-table-add-review
            table.rating-bar-table
              tbody
                tr
                  td 5
                  td.one-star-sprite
                  td
                    div.bar(style=`width:${avgRatingPercentage[4]}%`)
                tr
                  td 4
                  td.one-star-sprite
                  td
                    div.bar(style=`width:${avgRatingPercentage[3]}%`)
                tr
                  td 3
                  td.one-star-sprite
                  td
                    div.bar(style=`width:${avgRatingPercentage[2]}%`)
                tr
                  td 2
                  td.one-star-sprite
                  td
                    div.bar(style=`width:${avgRatingPercentage[1]}%`)
                tr
                  td 1
                  td.one-star-sprite
                  td
                    div.bar(style=`width:${avgRatingPercentage[0]}%`)
            button(id=`review-for-${hike.id}`).btn.review-btn Write a Review
          div.bg-modal.hidden
            form(id='review-form' class="hidden form-control")
                div.form-star-rating
                  button.star &#9734
                  button.star &#9734
                  button.star &#9734
                  button.star &#9734
                  button.star &#9734
                +field("Comment", "comment", null, false, "textarea")
                +field("Date Hike", "dateHike", null, false, "date")
                div.errors
                div.review-buttons
                  button#review-cancel.btn Cancel
                  button#review-submit.btn  Submit
          each review in reviews
            #review.form-control
              div.rating-username
                  .username #{review.User.username}
                  .stars-and-rating
                    div.stars
                      span.star-sprite(style=`width:${review.rating/5*100}%`)
                    #rating #{review.rating}
              .comment #{review.comment}
              if (review.dateHike)
                .dateHike Date hiked #{review.dateHike}
      div.hike-side
        div.hike-tags-wrap
          div.hike-tags-title Features
          div.hike-tags
            each tag in hike.Tags
              div.hike-tag #{tag.name}
        div.hike-add-collection
          if collections
            div.hike-collection-wrap
              if collections[0].inCollection
                button.hike-coll-want Want To Hike
                  span.checkMk âœ“
              else
                button.hike-coll-want Want To Hike
                  span.checkMk
              button.hike-coll-arrow
                i.fa-solid.fa-angle-down
              div.dropdown-menu.hidden
                each collection in collections
                  div.dropdown-item
                    input.coll-ckbx(type="checkbox" checked=collection.inCollection id=`collectionId-${collection.id}`)
                    label.coll-label(for=`collectionId-${collection.id}`) #{collection.name}
                div.dropdown-divider
                  div.add-collection-title Add New Collection
                  div.add-collection-frm
                    input.add-collection-input(type="text" name="add-new-coll" id="add-new-coll")
                    button.btn.btn-sm#add-collection Add
                div.dropdown-bottom#update-collect Update Collection
              div.update-status
          else
            div Signup to use our collections
